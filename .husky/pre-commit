#!/bin/bash

# Check for unwanted lock files in staged changes
if git diff --cached --name-only | grep -E '^(package-lock\.json|pnpm-lock\.yaml|bun\.lockb)$' > /dev/null; then
  echo "Error: Commits containing 'package-lock.json', 'pnpm-lock.yaml', or 'bun.lockb' are not allowed."
  echo "Please use Yarn and remove these files from your commit."
  exit 1
fi

# Allow only yarn.lock (optional but exclusive)
if git diff --cached --name-only | grep -E '^(package-lock\.json|pnpm-lock\.yaml|bun\.lockb)$' > /dev/null; then
  echo "Error: Only 'yarn.lock' is allowed as a lock file. Please remove other lock files."
  exit 1
fi